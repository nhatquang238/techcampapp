// helper function to map value
map_range=function(e,t,n,r,i){return e<t?r:e>n?i:r+(i-r)*(e-t)/(n-t)};iPhone=new View({x:200,y:50,width:320,height:568});app.superView=iPhone;talk3.dragger=new ui.Draggable(talk3);talk3.on(Events.DragMove,function(){talk3.y=talk3.originalFrame.y;saveTalk3.opacity=map_range(talk3.x,0,200,0,1)});talk3.dragger.on(Events.DragEnd,function(){if(talk3.x>200){talk3.animateDefault({x:talk3.originalFrame.x+iPhone.frame.width*2});utils.delay(200,function(){talk4.animateDefault({y:talk4.originalFrame.y-talk3.height});talk4.style={"z-index":"5"}})}else talk3.animateDefault({x:talk3.originalFrame.x})});doneVoteBtn1.opacity=0;doneVoteBtn1.scale=2;doneVoteBtn1.visible=!1;voteBtn1.on("click",function(){voteBtn1.animateDefault({opacity:0,scale:0});utils.delay(200,function(){voteBtn1.visible=!1});doneVoteBtn1.visible=!0;doneVoteBtn1.animateDefault({opacity:1,scale:1})});doneVoteBtn1.on("click",function(){doneVoteBtn1.animateDefault({opacity:0,scale:2});utils.delay(200,function(){doneVoteBtn1.visible=!1});voteBtn1.visible=!0;voteBtn1.animateDefault({opacity:1,scale:1})});searchField=new View({x:16,y:11,width:608,height:58});searchField.originalFrame=searchField.frame;searchField.superView=searchBar;searchField.style={background:"white","border-radius":"6px","z-index":"1"};searchLabel.style={"z-index":"2"};revealThemes=function(){searchLabel.animateDefault({x:35});searchField.animateDefault({width:480});searchTalk.style={"z-index":"5"};searchTalk.y=statusBar.height+searchBar.height;themes.y=searchTalk.originalFrame.height;keyboard.y=searchTalk.originalFrame.height;themes.animateDefault({y:themes.originalFrame.y});utils.delay(200,function(){keyboard.animateDefault({y:keyboard.originalFrame.y})})};searchField.on("click",revealThemes);searchLabel.on("click",revealThemes);hideSearch=function(){searchLabel.animateDefault({x:searchLabel.originalFrame.x});searchField.animateDefault({width:searchField.originalFrame.width});keyboard.animateDefault({y:searchTalk.originalFrame.height});utils.delay(200,function(){themes.animateDefault({y:searchTalk.originalFrame.height})});utils.delay(400,function(){searchTalk.y=searchTalk.originalFrame.y;themes.y=themes.originalFrame.y;keyboard.y=keyboard.originalFrame.y});utils.delay(600,function(){content.animateDefault({y:content.originalFrame.y});utils.delay(200,function(){searchBar.visible=!1})})};cancelSearch.on("click",hideSearch);content.dragger=new ui.Draggable(content);content.on(Events.DragMove,function(){searchBar.visible=!0;content.x=content.originalFrame.x;content.y<content.originalFrame.y&&(switchView.visible=!1)});content.dragger.on(Events.DragEnd,function(){if(content.y>content.originalFrame.y+searchBar.height/2)content.animateDefault({y:content.originalFrame.y+searchBar.height});else{content.animateDefault({y:content.originalFrame.y});searchBar.visible=!1}});slideTalkRight=function(e){e.animateDefault({x:e.x+e.width})};slideDownTalk=function(e,t){for(var n=e.length-1;n>=0;n--)e[n].animate({properties:{y:e[n].y+t.height},time:500,curve:"ease-out"})};slideTalkLeft=function(e){e.animateDefault({x:e.x-e.width})};slideUpTalk=function(e,t){for(var n=e.length-1;n>=0;n--)e[n].animate({properties:{y:e[n].y-t.height},time:500,curve:"ease-out"})};switchBtn=new View({x:votingBtn.originalFrame.x,y:votingBtn.originalFrame.y,width:200,height:60});switchBtn.originalFrame=switchBtn.frame;switchBtn.superView=switchView;switchBtn.style={background:"#fff","border-top-left-radius":"12px","border-bottom-left-radius":"12px"};votingActive.visible=!0;votingActive.style={"z-index":"5"};scheduleBtn.on("click",function(){switchBtn.animateDefault({width:switchBtn.originalFrame.width*2});utils.delay(100,function(){votingActive.visible=!1;scheduleActive.visible=!0;scheduleActive.style={"z-index":"5"}});utils.delay(200,function(){switchBtn.animateDefault({x:switchBtn.originalFrame.x+switchBtn.originalFrame.width,width:switchBtn.originalFrame.width})});switchBtn.style={"border-top-left-radius":"0px","border-bottom-left-radius":"0px","border-top-right-radius":"12px","border-bottom-right-radius":"12px"};saveTalk3.visible=!1;slideTalkRight(talk1);utils.delay(100,function(){slideTalkRight(talk2)});utils.delay(200,function(){slideTalkRight(talk3);timeline.opacity=0;slideTalkRight(timeline);slideTalkRight(talk1full)});utils.delay(300,function(){slideTalkRight(talk4);slideTalkRight(talk2full)});utils.delay(400,function(){slideTalkRight(talk3full)});utils.delay(600,function(){timeline.animate({time:200,curve:"ease-out",properties:{opacity:1,y:timeline.originalFrame.y+timeline.height}});slideDownTalk([talk1full,talk2full,talk3full],timeline)})});votingBtn.on("click",function(){switchBtn.animateDefault({x:switchBtn.originalFrame.x,width:switchBtn.originalFrame.width*2});utils.delay(200,function(){switchBtn.animateDefault({width:switchBtn.originalFrame.width});votingActive.visible=!0;scheduleActive.visible=!1;votingActive.style={"z-index":"5"}});switchBtn.style={"border-top-left-radius":"12px","border-bottom-left-radius":"12px","border-top-right-radius":"0px","border-bottom-right-radius":"0px"};timeline.animate({time:200,curve:"ease-out",properties:{opacity:0,y:timeline.originalFrame.y}});slideUpTalk([talk1full,talk2full,talk3full],timeline);utils.delay(500,function(){slideTalkLeft(talk1full);slideTalkLeft(timeline);utils.delay(100,function(){slideTalkLeft(talk2full)});utils.delay(200,function(){slideTalkLeft(talk3full);slideTalkLeft(talk1)});utils.delay(300,function(){slideTalkLeft(talk2)});utils.delay(400,function(){slideTalkLeft(talk3)});utils.delay(500,function(){slideTalkLeft(talk4);timeline.opacity=1})})});